<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SVG Drawing Tool</title>

  <style>
    * {
      box-sizing: border-box;
      font-family: Arial, sans-serif;
    }

    body {
      margin: 0;
      padding: 20px;
      background: #f4f6f9;
    }

    h1 {
      text-align: center;
      margin-bottom: 15px;
    }

    /* Toolbar */
    .toolbar {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin-bottom: 15px;
    }

    .toolbar select,
    .toolbar input,
    .toolbar button {
      padding: 8px 12px;
      border-radius: 6px;
      border: 1px solid #ccc;
      font-size: 14px;
      cursor: pointer;
    }

    .toolbar button {
      background: #3498db;
      color: white;
      border: none;
    }

    .toolbar button:hover {
      background: #2980b9;
    }

    /* Canvas Wrapper */
    .canvas-wrapper {
      width: 100%;
      height: 70vh; /* Responsive height */
      max-width: 1200px;
      margin: auto;
      background: #fff;
      border: 2px solid #ddd;
      border-radius: 10px;
      overflow: hidden;
    }

    /* SVG Canvas */
    svg {
      width: 100%;
      height: 100%;
      background: #fafafa;
      cursor: crosshair;
    }

    /* Footer */
    .info {
      text-align: center;
      margin-top: 10px;
      color: #555;
      font-size: 14px;
    }
  </style>
</head>
<body>

  <h1>SVG Drawing Tool</h1>

  <!-- Toolbar -->
  <div class="toolbar">

    <label>
      Shape:
      <select id="shapeSelect">
        <option value="free">Free Draw</option>
        <option value="line">Line</option>
        <option value="rect">Rectangle</option>
        <option value="circle">Circle</option>
      </select>
    </label>

    <label>
      Color:
      <input type="color" id="colorPicker" value="#000000">
    </label>

    <label>
      Size:
      <input type="number" id="strokeSize" value="3" min="1" max="20">
    </label>

    <button id="undoBtn">Undo</button>
    <button id="clearBtn">Clear</button>

  </div>


  <!-- SVG Canvas -->
  <div class="canvas-wrapper">
    <svg id="canvas" viewBox="0 0 1000 600" preserveAspectRatio="xMidYMid meet"></svg>
  </div>


  <div class="info">
    Select a shape and draw using mouse or touch.
  </div>


  <script>

    const svg = document.getElementById("canvas");
    const shapeSelect = document.getElementById("shapeSelect");
    const colorPicker = document.getElementById("colorPicker");
    const strokeSize = document.getElementById("strokeSize");
    const undoBtn = document.getElementById("undoBtn");
    const clearBtn = document.getElementById("clearBtn");

    let isDrawing = false;
    let startX = 0;
    let startY = 0;
    let currentElement = null;

    let history = [];


    /* Convert Mouse Position to SVG Coordinates */
    function getMousePosition(evt) {
      const rect = svg.getBoundingClientRect();

      return {
        x: (evt.clientX - rect.left) * (1000 / rect.width),
        y: (evt.clientY - rect.top) * (600 / rect.height)
      };
    }


    /* Start Drawing */
    function startDraw(e) {
      isDrawing = true;

      const pos = getMousePosition(e);
      startX = pos.x;
      startY = pos.y;

      const color = colorPicker.value;
      const size = strokeSize.value;
      const shape = shapeSelect.value;

      if (shape === "free") {
        currentElement = document.createElementNS("http://www.w3.org/2000/svg", "path");
        currentElement.setAttribute("d", `M ${startX} ${startY}`);
      }
      else if (shape === "line") {
        currentElement = document.createElementNS("http://www.w3.org/2000/svg", "line");
        currentElement.setAttribute("x1", startX);
        currentElement.setAttribute("y1", startY);
        currentElement.setAttribute("x2", startX);
        currentElement.setAttribute("y2", startY);
      }
      else if (shape === "rect") {
        currentElement = document.createElementNS("http://www.w3.org/2000/svg", "rect");
        currentElement.setAttribute("x", startX);
        currentElement.setAttribute("y", startY);
        currentElement.setAttribute("width", 0);
        currentElement.setAttribute("height", 0);
      }
      else if (shape === "circle") {
        currentElement = document.createElementNS("http://www.w3.org/2000/svg", "circle");
        currentElement.setAttribute("cx", startX);
        currentElement.setAttribute("cy", startY);
        currentElement.setAttribute("r", 0);
      }

      currentElement.setAttribute("fill", "none");
      currentElement.setAttribute("stroke", color);
      currentElement.setAttribute("stroke-width", size);
      currentElement.setAttribute("stroke-linecap", "round");

      svg.appendChild(currentElement);
    }


    /* Draw */
    function draw(e) {
      if (!isDrawing || !currentElement) return;

      const pos = getMousePosition(e);
      const shape = shapeSelect.value;

      if (shape === "free") {
        let d = currentElement.getAttribute("d");
        d += ` L ${pos.x} ${pos.y}`;
        currentElement.setAttribute("d", d);
      }

      else if (shape === "line") {
        currentElement.setAttribute("x2", pos.x);
        currentElement.setAttribute("y2", pos.y);
      }

      else if (shape === "rect") {
        const width = pos.x - startX;
        const height = pos.y - startY;

        currentElement.setAttribute("width", Math.abs(width));
        currentElement.setAttribute("height", Math.abs(height));
        currentElement.setAttribute("x", width < 0 ? pos.x : startX);
        currentElement.setAttribute("y", height < 0 ? pos.y : startY);
      }

      else if (shape === "circle") {
        const r = Math.sqrt(
          Math.pow(pos.x - startX, 2) +
          Math.pow(pos.y - startY, 2)
        );

        currentElement.setAttribute("r", r);
      }
    }


    /* Stop Drawing */
    function stopDraw() {
      if (isDrawing && currentElement) {
        history.push(currentElement);
      }

      isDrawing = false;
      currentElement = null;
    }


    /* Undo */
    undoBtn.addEventListener("click", () => {
      const last = history.pop();

      if (last) {
        svg.removeChild(last);
      }
    });


    /* Clear */
    clearBtn.addEventListener("click", () => {
      svg.innerHTML = "";
      history = [];
    });


    /* Mouse Events */
    svg.addEventListener("mousedown", startDraw);
    svg.addEventListener("mousemove", draw);
    svg.addEventListener("mouseup", stopDraw);
    svg.addEventListener("mouseleave", stopDraw);


    /* Touch Support */
    svg.addEventListener("touchstart", e => {
      e.preventDefault();
      startDraw(e.touches[0]);
    });

    svg.addEventListener("touchmove", e => {
      e.preventDefault();
      draw(e.touches[0]);
    });

    svg.addEventListener("touchend", stopDraw);

  </script>

</body>
</html>